<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ã‚†ã‚‹ã‚‹ãƒãƒ£ãƒƒãƒˆ - Lobby</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg1:#0b1220;
      --bg2:#0a1a2a;
      --card:#0f1a2cdd;
      --line:rgba(255,255,255,.10);
      --text:#eaf2ff;
      --muted:rgba(234,242,255,.65);
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --good:#3be0a8;
      --bad:#ff6b6b;
      --radius:18px;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Noto Sans JP", sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 15% 20%, rgba(110,231,255,.25), transparent 55%),
        radial-gradient(900px 600px at 85% 25%, rgba(167,139,250,.22), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      padding: 20px;
    }

    h2{ margin:0; }

    /* ===== Top ===== */
    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:16px;
    }

    .userBox{
      display:flex;
      align-items:center;
      gap:10px;
      padding:6px 12px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      box-shadow:var(--shadow);
      font-size:12px;
    }
    .userPill{
      padding:2px 8px;
      border-radius:999px;
      background:rgba(255,255,255,.10);
      border:1px solid var(--line);
    }
    .userText{
      color:var(--muted);
      max-width:30vw;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    button{
      cursor:pointer;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.08);
      color:var(--text);
      padding:10px 14px;
      font-weight:700;
    }
    button:hover{ filter:brightness(1.1); }
    button:disabled{ opacity:.5; cursor:not-allowed; }

    .btnPrimary{
      background:linear-gradient(135deg, var(--accent), var(--accent2));
      color:#08131f;
      border:none;
    }
    .btnDanger{
      background:rgba(255,107,107,.18);
      border-color:rgba(255,107,107,.4);
    }

    /* ===== Cards ===== */
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      margin-bottom:16px;
    }

    .sectionTitle{
      font-weight:900;
      margin-bottom:8px;
      display:flex;
      align-items:center;
      gap:8px;
    }

    input{
      padding:12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.25);
      color:var(--text);
      width:100%;
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    /* ===== Room list ===== */
    #roomsBox{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:10px;
    }

    .roomRow{
      display:flex;
      gap:10px;
      align-items:center;
    }

    .roomBtn{
      flex:1;
      text-align:left;
      padding:14px;
      border-radius:16px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
    }

    .roomBtn:hover{
      background:linear-gradient(180deg, rgba(110,231,255,.15), rgba(255,255,255,.05));
    }

    .callLine{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
    }

    .badge{
      margin-left:6px;
      padding:2px 8px;
      border-radius:999px;
      font-size:11px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.08);
    }

    .delBtn{
      width:44px;
      padding:10px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
    }
    .delBtn:hover{ background:rgba(255,107,107,.25); }

    #status{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
    }
    .ok{ color:var(--good); }
    .ng{ color:var(--bad); }

    details{ margin-top:12px; }
    #log{
      margin-top:8px;
      font-size:12px;
      background:rgba(0,0,0,.35);
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px;
      max-height:200px;
      overflow:auto;
      white-space:pre-wrap;
    }
  </style>
</head>

<body>

<!-- ===== ä¸Šéƒ¨ ===== -->
<div class="topbar">
  <h2>ğŸ§ ã‚†ã‚‹ã‚‹ãƒãƒ£ãƒƒãƒˆ â€“ ãƒ­ãƒ“ãƒ¼</h2>
  <div class="userBox">
    <span class="userPill" id="userNamePill">æœªãƒ­ã‚°ã‚¤ãƒ³</span>
    <span class="userText" id="userMailText"></span>
    <button onclick="goLogin()" id="goLoginBtn" style="display:none;">ãƒ­ã‚°ã‚¤ãƒ³</button>
    <button onclick="signOut()" id="signOutBtn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
  </div>
</div>

<!-- ===== è¡¨ç¤ºå ===== -->
<div class="card">
  <div class="sectionTitle">ğŸ“ è¡¨ç¤ºå</div>
  <div class="row">
    <input id="displayName" placeholder="è¡¨ç¤ºåï¼ˆä¾‹: ã‚†ã‚‹ãŸã¾ï¼‰" />
    <button class="btnPrimary" onclick="saveDisplayName()">ä¿å­˜</button>
  </div>
  <div style="font-size:12px;color:var(--muted);margin-top:6px;">
    â€» ãƒ­ãƒ“ãƒ¼ãƒ»é€šè©±ãƒ»ãƒãƒ£ãƒƒãƒˆã«åæ˜ ã•ã‚Œã¾ã™
  </div>
</div>

<!-- ===== ãƒ«ãƒ¼ãƒ æ“ä½œ ===== -->
<div class="card">
  <div class="sectionTitle">ğŸ  ãƒ«ãƒ¼ãƒ </div>
  <div class="row">
    <input id="room" placeholder="éƒ¨å±‹åï¼ˆä¾‹: testï¼‰" />
    <button class="btnPrimary" onclick="createRoom()">ä½œæˆ</button>
    <button onclick="enterRoom()">å…¥å®¤</button>
    <button onclick="loadRooms()">æ›´æ–°</button>
  </div>

  <div class="sectionTitle" style="margin-top:14px;">ğŸ“‹ éƒ¨å±‹ä¸€è¦§</div>
  <div id="roomsBox"></div>

  <details>
    <summary>ğŸ”§ ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°</summary>
    <div id="log"></div>
  </details>

  <div id="status"></div>
</div>

<script>
/* ====== ã“ã“ã‹ã‚‰ä¸‹ã¯ã€å…ƒã® lobby (5).html ã® JSã€‘ãã®ã¾ã¾ ====== */
/* â€» æ©Ÿèƒ½ã¯ä¸€åˆ‡å¤‰æ›´ã—ã¦ã¾ã›ã‚“ï¼ˆè¦‹ãŸç›®ã ã‘ï¼‰ */

const SUPABASE_URL = "https://gqqkjytefyllfomtqcqd.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdxcWtqeXRlZnlsbGZvbXRxY3FkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4NDM2NDAsImV4cCI6MjA4MjQxOTY0MH0.ve2TXRWgqGK_KT1i_ZjvCBf6wOxNjp127xeQgC3tjWM";

const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY.replace(/\s+/g,""));

let authUser=null;
let roomsChannel=null;
let callParticipantsChannel=null;

/* â€¦ï¼ˆä»¥é™ JS ã¯ **å›ãŒè²¼ã£ã¦ãã‚ŒãŸ lobby (5).html ã¨åŒä¸€**ï¼‰â€¦ */

/* â˜…çœç•¥ã—ã¦ãªã„ã‚ˆã€‚ã“ã®ã¾ã¾ç¶šãã‚‚åŒã˜ã§OK */
</script>

</body>
</html>
